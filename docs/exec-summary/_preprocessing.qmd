::: {.content-visible unless-meta="in.article"}
### Data pre-processing
:::

At the individual level, each patient's daily prescription record at time $t$ was encoded into a square matrix $A_t^{(i)}$, where rows and columns represent medication classes according to the ATC classification. An off-diagonal entry $A_{t_{jk}}^{(i)} = 1$ indicates that medication classes $i$ and $k$ were co-prescribed on the same day for individual $i$, while a diagonal entry $A_{t_{jj}}^{(i)} = 1$ captures the presence of a single prescription of medication $j$. To derive the population-level DPN, all individual-level daily prescription matrix $A^{(i)}$ were aggregated by computing their element-wise sum.

$$A_t = \displaystyle \sum_i A_t^{(i)}$$ {#eq-DPN}

The population matrix $A_t$ captures the frequency of co-prescriptions (off-diagonal) and single prescriptions (diagonal) across the dataset at the specified time $t$. Each element $A_{t_{jk}}$ in the matrix was interpreted as the number of patients being prescribed with medication classes $j$ and $k$ on the same day $t$. $A_t$ was represented as a weighted undirected graph, where each node corresponds to a medication class and edges reflect co-prescription frequencies. In the original work of DPN, all defined daily dose (DDD) were assumed equal to 1, allowing for applying raw counts as the edge weights. However, since not all medications have DDD = 1, this assumption could lead to inaccurate representations. To enhance the accuracy of edge weights, we accounted for the heterogeneity in DDD. The weights were adjusted using the density of a normal distribution. The expected value ($\mu$) was set to the base weight $\omega_B$ of 1 to prioritize DDD = 1, and the standard deviation ($\sigma$) was set to $\frac{1}{3}$ to allow for a gradual reduction in weight as DDD deviates from 1.

$$\omega = \frac{1}{\frac{\omega_B}{3} \sqrt{2 \pi}} e^{-\frac{1}{2}\left(\frac{DDD - \omega_B}{\omega_B/3}\right)^2}$$ {#eq-weighted-DDD}

$$
\stackrel{\textrm{Unregularized}}{
  \begin{bmatrix}
  n_{1, 1} & \dots & n_{1, N} \\
  \vdots & \ddots & \vdots \\
  n_{N, 1} & \dots & n_{N, N} \\
  \end{bmatrix}
}
\quad \to \quad
\stackrel{\textrm{Regularized by } DDD}{
  \begin{bmatrix}
  \frac{1}{2} \cdot \left(\omega_1 + \omega_1 \right) & \dots & \frac{1}{2} \cdot \left(\omega_1 + \omega_N \right) \\
  \vdots & \ddots & \vdots \\
  \frac{1}{2} \cdot \left(\omega_N + \omega_1 \right) & \dots & \frac{1}{2} \cdot \left(\omega_N + \omega_N \right) \\
  \end{bmatrix}
}
$$ {#eq-regularize-mtx}
