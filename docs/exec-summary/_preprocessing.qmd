::: {.content-visible unless-meta="in.article"}
### Data pre-processing
:::

At the individual level, each patient's daily prescription record at time $t$ was encoded into a square matrix $A_t^{(p)}$, where rows and columns represent medication classes according to the ATC classification. An off-diagonal entry $A_{t_{ij}}^{(p)} = 1$ indicates that medication classes $i$ and $j$ were co-prescribed on the same day for individual $p$, while a diagonal entry $A_{t_{ii}}^{(p)} = 1$ captures the presence of a single prescription of medication $i$. To derive the population-level DPN, all individual-level daily prescription matrix $A^{(p)}$ were aggregated by computing their element-wise sum.

$$A_t = \displaystyle \sum_i A_t^{(p)}$$ {#eq-DPN}

The population matrix $A_t$ captures the frequency of co-prescriptions (off-diagonal) and single prescriptions (diagonal) across the dataset at the specified time $t$. Each element $A_{t_{ij}}$ in the matrix was interpreted as the number of patients being prescribed with medication classes $i$ and $j$ on the same day $t$. $A_t$ was represented as a weighted undirected graph, where each node corresponds to a medication class and edges reflect co-prescription frequencies. In the original work of DPN, all defined daily dose (DDD) were assumed equal to 1, allowing for applying raw counts as the edge weights. However, since not all medications have DDD = 1, this assumption could lead to inaccurate representations. To enhance the accuracy of edge weights, we introduced a weighting function to adjust the contribution of each co-prescription. Specifically, each co-prescribed medication class was assigned a weight $\omega_j$ based on its DDD value using a Gaussian kernel centered at the baseline weight $\omega_B = 1$, i.e., the expected DDD, with standard deviation $\sigma = \frac{1}{3}$ to allow for a gradual reduction in weight as DDD deviates from 1.

$$\omega_j = \frac{1}{\frac{\omega_B}{3} \sqrt{2 \pi}} e^{-\frac{1}{2}\left(\frac{DDD - \omega_B}{\omega_B/3}\right)^2}$$ {#eq-weighted-DDD}

The edge weight between medication classes $i$ and $j$ was computed as the average of their individual weights:

$$
\stackrel{\textrm{Unregularized}}{
  \begin{bmatrix}
  n_{1, 1} & \dots & n_{1, N} \\
  \vdots & \ddots & \vdots \\
  n_{N, 1} & \dots & n_{N, N} \\
  \end{bmatrix}
}
\quad \to \quad
\stackrel{\textrm{Regularized by } DDD}{
  \begin{bmatrix}
  \frac{1}{2} \cdot \left(\omega_1 + \omega_1 \right) & \dots & \frac{1}{2} \cdot \left(\omega_1 + \omega_N \right) \\
  \vdots & \ddots & \vdots \\
  \frac{1}{2} \cdot \left(\omega_N + \omega_1 \right) & \dots & \frac{1}{2} \cdot \left(\omega_N + \omega_N \right) \\
  \end{bmatrix}
}
$$ {#eq-regularize-mtx}

This weighting approach scaled the edge weight that deviate substantially from the standard $\omega_B = 1$, improving comparability across medication classes. To remain consistent with standard network representations and avoid confounding self-loops, the diagonal elements were omitted.
